<!DOCTYPE html>
<html>
<head>
  <title>Marketing Template Editor</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background-color: #f4f4f4;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h1 { margin: 20px; }
    .controls {
      width: 100%;
      max-width: 1200px;
      margin-bottom: 20px;
      background: #fff;
      padding: 15px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .template-box {
      width: 794px;             /* Fixed A4 width */
      height: 1123px;           /* Fixed A4 height */
      border: 2px dashed #aaa;
      background-color: transparent;
      background-size: cover;
      background-repeat: no-repeat;
      background-position: center;
      position: relative;
      overflow: hidden;         /* Disable scrolling */
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
      margin: 0 auto;
    }
    .draggable {
      position: absolute;
      cursor: move;
    }
    .thumbnail-slider {
      display: flex;
      gap: 10px;
      overflow-x: auto;
      margin-top: 10px;
      padding-bottom: 10px;
    }
    .thumbnail-slider img {
      width: 100px;
      height: 100px;
      object-fit: cover;
      border: 2px solid transparent;
      cursor: pointer;
    }
    .thumbnail-slider img:hover {
      border-color: #007bff;
     }
     

    /* base styles for store name */ */
    #storeFooterName {
      position: absolute;
      bottom: 35px;
      left: 50px;              /* distance above bottom of #storeFooter */
      max-width: 90%;
      line-height: 1.2;
      word-wrap: break-word;
      font-weight: bold;
      font-size: 14px;
      color: #000;
      z-index: 10000;
      box-sizing: border-box;
      text-align: left;      /* aligns text to the left */
      transform: none; 
    }

#storeFooterName {
    position: absolute;
    bottom: 35px;
    left: 50%; 
    transform: translateX(calc(-50% - 100px));          /* ðŸ‘ˆ this nudges just the text */
    max-width: 90%;
    line-height: 1.3;
    /* word-wrap: break-word; */
    white-space: nowrap;   
    font-weight: bold;
    font-size: 12px;
    color: #000;
    z-index: 10000;
    box-sizing: border-box;
    text-align: center;
}
#storeFooterName.right {
    right: 0;
    text-align: right;
    padding-right: 10px;  /* small gap from edge */
    transform: none;
}
</style>
</head>
<body>
  <h1>Marketing Template Editor</h1>
  <div class="controls">
    <div>
      <label>Upload Background Image:</label>
      <input type="file" id="bgUpload" accept="image/*">
    </div>
    <div>
      <label>Choose Background Color:</label>
      <input type="color" id="bgColor">
      <button onclick="applyColor()">Apply Color</button>
    </div>
    <div>
      <label>Upload Logo:</label>
      <input type="file" id="logoUpload" accept="image/*">
    </div>
    <div>
      <label>Add Footer Text:</label>
      <input type="text" id="footerName" placeholder="Store Name">
      <button onclick="addFooter()">Add Footer</button>
    </div>
    <div>
      <button onclick="downloadPNG()">Download PNG</button>
      <button onclick="downloadPDF()">Download (A4)</button>
    </div>
    <div>
      <label>Choose Store Name Color:</label>
      <input type="color" id="storeNameColor">
      <button onclick="applyStoreNameColor()">Apply Store Name Color</button>
</div>
  </div>


  <div style="margin: 20px 0; width:100%; max-width:1200px; background:#fff; padding:15px; box-shadow:0 2px 6px rgba(0,0,0,0.1);">
    <label>Upload Custom Template:</label>
    <input type="file" id="templateUpload" accept="image/*">
  </div>

  <div id="templateBox" class="template-box">
    <!-- Default store name + footer -->
    <p id="storeFooterName">Default Store Name</p>
    <div id="storeFooter"></div>
  </div>

  <h2>Templates</h2>
  <div class="thumbnail-slider" id="templateSlider"></div>

  <h2>Products</h2>
  <div class="thumbnail-slider" id="productSlider"></div>

  <h2>Banners</h2>
  <div class="thumbnail-slider" id="bannerSlider"></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <script>
    const templateBox = document.getElementById("templateBox");
    const templateSlider = document.getElementById("templateSlider");
    const productSlider = document.getElementById("productSlider");
    const bannerSlider = document.getElementById("bannerSlider");

    function makeDraggable(el) {
      el.onmousedown = function(e) {
        e.preventDefault();
        let shiftX = e.clientX - el.getBoundingClientRect().left;
        let shiftY = e.clientY - el.getBoundingClientRect().top;
        function moveAt(pageX, pageY) {
          el.style.left = pageX - shiftX - templateBox.getBoundingClientRect().left + "px";
          el.style.top = pageY - shiftY - templateBox.getBoundingClientRect().top + "px";
        }
        function onMouseMove(e) {
          moveAt(e.pageX, e.pageY);
        }
        document.addEventListener("mousemove", onMouseMove);
        document.onmouseup = function() {
          document.removeEventListener("mousemove", onMouseMove);
          document.onmouseup = null;
        };
      };
      el.ondragstart = function() { return false; };
    }

    document.getElementById("bgUpload").addEventListener("change", function(e) {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(ev) {
          templateBox.style.backgroundImage = `url(${ev.target.result})`;
        };
        reader.readAsDataURL(file);
      }
    });

    function applyColor() {
      const color = document.getElementById("bgColor").value;
      templateBox.style.backgroundImage = "";
      templateBox.style.backgroundColor = color;
    }

    document.getElementById("logoUpload").addEventListener("change", function(e) {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(ev) {
          const logo = document.createElement("img");
          logo.src = ev.target.result;
          logo.className = "draggable";
          logo.style.width = "150px";
          logo.style.height = "auto";
          logo.style.top = "20px";
          logo.style.left = "20px";
          templateBox.appendChild(logo);
          makeDraggable(logo);
        };
        reader.readAsDataURL(file);
      }
    });

    function addFooter() {
      const storeNameInput = document.getElementById("footerName").value;
      const storeNameEl = document.getElementById("storeFooterName");
      storeNameEl.textContent = storeNameInput || "Default Store Name";
    }

    async function downloadPNG() {
      const canvas = await html2canvas(templateBox);
      const link = document.createElement("a");
      link.download = "template.png";
      link.href = canvas.toDataURL();
      link.click();
    }

    async function downloadPDF() {
      const { jsPDF } = window.jspdf;
      const canvas = await html2canvas(templateBox, { scale: 2 });
      const imgData = canvas.toDataURL("image/png");
      const pdf = new jsPDF("p", "pt", "a4");
      const pageWidth = pdf.internal.pageSize.getWidth();
      const pageHeight = pdf.internal.pageSize.getHeight();
      pdf.addImage(imgData, "PNG", 0, 0, pageWidth, pageHeight);
      pdf.save("template.pdf");
    }

    // Preloaded templates
    const preloadedTemplates = ["template1.jpg", "template2.jpg"];
    preloadedTemplates.forEach(src => {
      const slide = document.createElement("img");
      slide.src = src;
      templateSlider.appendChild(slide);
      slide.addEventListener("click", function() {
        templateBox.style.width = "794px";
        templateBox.style.height = "1123px";
        templateBox.style.margin = "0 auto";
        templateBox.style.display = "block";
        templateBox.style.backgroundImage = `url(${src})`;
        templateBox.style.backgroundSize = "cover";
        templateBox.style.backgroundPosition = "center";
        templateBox.style.backgroundRepeat = "no-repeat";
        Array.from(templateBox.children).forEach(child => {
          if (child.id !== "storeFooter" && child.id !== "storeFooterName") child.remove();
        });
      });
    });

    // Custom template upload
    document.getElementById("templateUpload").addEventListener("change", function(e) {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(ev) {
          const slide = document.createElement("div");
          slide.className = "slide";
          slide.innerHTML = `<img src="${ev.target.result}" alt="Custom Template">
                             <div class="name">Custom Template</div>`;
          slide.addEventListener("click", function() {
            templateBox.style.width = "794px";
            templateBox.style.height = "1123px";
            templateBox.style.margin = "0 auto";
            templateBox.style.display = "block";
            templateBox.style.backgroundImage = `url(${ev.target.result})`;
            templateBox.style.backgroundSize = "cover";
            templateBox.style.backgroundPosition = "center";
            templateBox.style.backgroundRepeat = "no-repeat";
            Array.from(templateBox.children).forEach(child => {
              if (child.id !== "storeFooter" && child.id !== "storeFooterName") child.remove();
            });
            if (!document.getElementById("storeFooterName")) {
              const nameEl = document.createElement("p");
              nameEl.id = "storeFooterName";
              nameEl.textContent = "Default Store Name";
              templateBox.appendChild(nameEl);
            }
          });
          templateSlider.appendChild(slide);
        };
        reader.readAsDataURL(file);
      }
    });
  </script>
  <script>
  function applyStoreNameColor() {
    const color = document.getElementById("storeNameColor").value;
    const storeName = document.getElementById("storeFooterName");
    if (storeName) {
      storeName.style.color = color;
    }
  }
</script>
<script>
  function addFooter() {
    const storeNameInput = document.getElementById("footerName").value;
    const storeNameEl = document.getElementById("storeFooterName");
    // Use the input store name, or fallback to a default.
    const nameText = storeNameInput || "Default Store Name";
    // Build the innerHTML with the store name and an appended logo image.
    // Adjust the image src, style (e.g., height) as needed.
    storeNameEl.innerHTML = nameText + ' <img src="/static/images/logo.png" style="vertical-align:middle; height:20px; margin-left:5px;">';
  }
</script>
 </body>
</html>
